#!/bin/sh

fin=$1
fout=$2

if [ ! -f $fin ]; then
  echo "input file $fin does not exist"
  exit 1
fi

echo "# GENERATED BY oflags.sh" > $fout
sed -n -E 's/.*(OVL_[[:alnum:]]+)[[:space:]]+\([[:space:]]*1[[:space:]]*<<[[:space:]]*([[:digit:]]*).*/\1 \2/p' $fin | awk 'BEGIN{x=0} ; $2>x{x=$2} {print $1 " = (1 << " $2 ")"} ; END{print "OVL_CUSTOM = (1 << " x+1 ")"}' >> $fout
